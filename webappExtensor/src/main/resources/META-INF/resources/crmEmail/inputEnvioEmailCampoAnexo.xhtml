<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:cc="http://java.sun.com/jsf/composite"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:SBAcaoNav="http://xmlns.jcp.org/jsf/composite/SBComp/composite/acoesENavegacao"
    xmlns:crmEmail="http://xmlns.jcp.org/jsf/composite/crm"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://xmlns.jcp.org/jsf/core">


    <!-- INTERFACE -->
    <cc:interface>
        <cc:attribute name="email"
                      type="com.super_bits.Casa_Nova.Intranet_Marketing_Digital.model.dados.crm.mail.envioEmail.envioEmail.EnvioEmail" required="true"/>
        <cc:attribute name="colunasLocalizacao" default="10" />
        <cc:attribute name="colunasBotaoInsersao" default="1" />



    </cc:interface>
    <!-- IMPLEMENTATION -->
    <cc:implementation>

        <h:panelGroup id="compEmailAnexos"  styleClass="Container12" layout="block" >

            <h:panelGroup layout="block" styleClass="Container#{cc.attrs.colunasLocalizacao}" >
                <p:autoComplete
                    id="campo-email-anexos" multiple="true"

                    value="#{cc.attrs.email.arquivosAnexados}"
                    completeMethod="#{servicoEmail.anexosDisponiveisByFiltroTermo}"
                    autoSelection="true"
                    itemtipAtPosition="bottom"
                    placeholder="ANEXOS: procure aqui por anexos da pessoa, e apresentações cadastradas"
                    styleClass="autoCompleteResponsivo autoCompleteAnexos"
                    var="arquivoAnexo" itemLabel="#{arquivoAnexo.arquivo}" itemValue="#{arquivoAnexo}"
                    converter="conversorGenerico"

                    forceSelection="true">
                    <f:facet name="itemtip">

                        <h1>#{arquivoAnexo.nome} </h1>

                    </f:facet>
                    <f:passThroughAttribute name="caminhoCampo" value="#{cc.attrs.email.getCampoInstanciadoByNomeOuAnotacao('arquivosAnexados').nomeCompostoIdentificador}" />
                    <f:passThroughAttribute name="dominio" value="#{cc.attrs.email.getCampoInstanciadoByNomeOuAnotacao('arquivosAnexados').nomeClasseOrigemAtributo}" />
                    <f:passThroughAttribute name="campoInstanciado" value="#{cc.attrs.email.getCampoInstanciadoByNomeOuAnotacao('arquivosAnexados')}" />

                    <p:ajax event="itemSelect"
                            update="@form"
                            process="@this"
                            >

                    </p:ajax>
                    <p:ajax event="itemUnselect"
                            update="@form"
                            process="@this"
                            >

                    </p:ajax>

                    <p:column style="width:10%" styleClass="">
                        <i class="#{arquivoAnexo.icone} Fs20"  > </i>
                    </p:column>
                    <p:column styleClass="FontAdamantiumBold Fs16">
                        <h:outputText styleClass="" style="" value="#{arquivoAnexo.nome}" />
                    </p:column>
                    <p:column width="200px" styleClass="FontAdamantiumBold Fs16">
                        <h:outputText styleClass="FontAdamantiumBold"  value="#{arquivoAnexo.tipoAnexo}"  />
                    </p:column>
                    <p:column width="200px" styleClass="FontAdamantiumBold Fs16">
                        <h:outputText styleClass="FontAdamantiumBold"  value="#{pgUtil.gerarDataHoraTextoResumido(arquivoAnexo.dataHoraCriacao)}"  />
                    </p:column>

                </p:autoComplete>
            </h:panelGroup>

            <h:panelGroup layout="block" styleClass="Container#{cc.attrs.colunasBotaoInsersao}" >

                <p:fileUpload uploadLabel="Anexar" label="#{cc.attrs.email.prospecto==null?'Pessoa não selecionada':'Anexar do meu dispositivo'}"
                              listener="#{pgUtilUploadDeAnexoEmail.enviarArquivo}"
                              onstart="atualizarValoresUploadDireto();"
                              disabled="#{cc.attrs.email.prospecto==null}"
                              oncomplete="atualizaranexos()"
                              mode="advanced"
                              multiple="false"
                              style="width: 400px;"
                              auto="true"
                              sizeLimit="10050000"
                              >

                </p:fileUpload>
            </h:panelGroup>
        </h:panelGroup>

    </cc:implementation>
</ui:composition>