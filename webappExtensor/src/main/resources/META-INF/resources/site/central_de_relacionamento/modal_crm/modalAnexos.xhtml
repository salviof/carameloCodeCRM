<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:SBInput="http://xmlns.jcp.org/jsf/composite/SBComp/composite/input"
    xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
    xmlns:SBAcaoNav="http://xmlns.jcp.org/jsf/composite/SBComp/composite/acoesENavegacao"
    xmlns:SBForm="http://xmlns.jcp.org/jsf/composite/SBComp/composite/formulario"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:p="http://primefaces.org/ui">


    <h:form>


        <h:panelGroup id="subForm" styleClass="Container12 Responsive" >
            <h:panelGroup  styleClass="invisivel" layout="block" >

                <p:commandButton
                    id="botaoRemoverSubform"
                    process="@parent"
                    action="#{pgModalProspecto.prospectoSelecionado.getCampoInstanciadoByNomeOuAnotacao('arquivos').comoSubItens.subItens.removerItemSelecionadoPeloIndice()}"
                    update="#{pgUtil.makeCaminhoCompletoID('subForm')}"
                    styleClass="invisivel"
                    />
                <h:inputText  id="indiceSubformulario"  styleClass="invisivel"  />



            </h:panelGroup>


            <h:panelGroup styleClass="Fright" layout="block" >

                <p:commandButton
                    icon="fa fa-plus-square-o"
                    actionListener="#{pgModalProspecto.prospectoSelecionado.getCampoInstanciadoByNomeOuAnotacao('arquivos').comoSubItens.subItens.adicionarItem()}"
                    update="#{pgUtil.makeCaminhoCompletoID('subForm')}"
                    process="@this"
                    value="#{pgModalProspecto.prospectoSelecionado.getCampoInstanciadoByNomeOuAnotacao('arquivos').comoSubItens.subItens.acaoAdicionarItem.nomeAcao}"

                    onstart="bloquearTodosCommandLinks()"
                    oncomplete="desbloquearTodosCommandLinks()"
                    />

            </h:panelGroup>
            <h:panelGroup  id="teste123">

                <table class="table table-striped" id="teste123">
                    <thead>
                        <tr>


                            <th>Data Envio do arquivo</th>
                            <th>Arquivo</th>

                            <th>-</th>
                        </tr>
                    </thead>
                    <tbody>

                        <ui:repeat value="#{pgModalProspecto.prospectoSelecionado.getCampoInstanciadoByNomeOuAnotacao('arquivos').valor}" var="itemDaLista" varStatus="infoRec"  >
                            <tr scope="row" id="#{infoRec.index}">


                                <td class="col-md-1">

                                    <p:fragment>

                                        <SBInput:input
                                            registro="#{itemDaLista.getCampoByNomeOuAnotacao('dataHoraCriacao')}"
                                            layout="#{layoutsComponenteSB.layoutCampo.semLabel}"
                                            idAtualizarOnChange="@this"
                                            transient="false"
                                            desabilitarEdicao="true"
                                            rendered="#{itemDaLista.getCampoByNomeOuAnotacao('dataHoraCriacao').valor!=null}"
                                            />
                                        <p:outputLabel value="Agora mesmo."
                                                       rendered="#{itemDaLista.getCampoByNomeOuAnotacao('dataHoraCriacao').valor==null}"
                                                       />
                                    </p:fragment>


                                </td>
                                <td class="col-md-3">

                                    <p:fragment>

                                        <SBInput:input
                                            registro="#{itemDaLista.getCampoByNomeOuAnotacao('arquivo')}"

                                            layout="#{layoutsComponenteSB.layoutCampo.semLabel}"
                                            idAtualizarOnChange="@this"
                                            transient="false"
                                            desabilitarEdicao="#{itemDaLista.getCampoByNomeOuAnotacao('arquivo').comoArquivoDeEntidade.existeArquivo}"
                                            />
                                    </p:fragment>


                                </td>



                                <td class="col-md-1" >
                                    <p:commandLink
                                        process="@this"
                                        rendered="#{!cc.attrs.somenteLeitura}"
                                        styleClass="botaoRemover"
                                        onmouseup="bloquearTodosCommandLinks()"
                                        onstart="bloquearTodosCommandLinks()"
                                        oncomplete="desbloquearTodosCommandLinks()"
                                        onclick="modificarIntputEclicar('#{pgUtil.gerarCaminhoCompletoIDParaJavaScript('botaoRemoverSubform')}', '#{pgUtil.gerarCaminhoCompletoIDParaJavaScript('indiceSubformulario')}', '#{infoRec.index}')">
                                        <i class="fa fa-times Fs30" aria-hidden="true"></i>

                                    </p:commandLink>
                                </td>
                            </tr>

                        </ui:repeat>
                    </tbody>

                </table>

            </h:panelGroup>

        </h:panelGroup>



        <div class="Container12"  >
            <div class="Fright">
                <SBAcaoNav:botaoDeAcao metodo="#{pgModalProspecto.salvarAnexos()}"
                                       label="Salvar Alterações"
                                       acao="#{pgModalProspecto.acaoSalvarAlteracoes}"
                                       tipoVisualizacao="#{layoutsComponenteSB.layoutBotoes.iconeENome}"
                                       />
            </div>
        </div>

    </h:form>




</ui:composition>











