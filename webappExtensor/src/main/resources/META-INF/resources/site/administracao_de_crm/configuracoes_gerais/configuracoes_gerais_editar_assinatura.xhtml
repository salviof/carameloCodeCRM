<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:SBCRM="http://xmlns.jcp.org/jsf/composite/crm"
    xmlns:SBFormulario="http://xmlns.jcp.org/jsf/composite/SBComp/composite/formulario"
    xmlns:SBAcao="http://xmlns.jcp.org/jsf/composite/SBComp/composite/acoesENavegacao"
    xmlns:pe="http://primefaces.org/ui/extensions"
    xmlns:p="http://primefaces.org/ui"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:form>
        <p:fragment>
            <SBAcao:botaoDeAcao metodo="#{pgConfiguracoes.executarAcaoSelecionada()}"
                                update="@form"
                                armazenamentoAcaoExecutada="#{pgConfiguracoes.acaoSelecionada}"
                                acao="#{acoesAdminCrm_ConfiguracoesGeraisMb.configuracoesGeraisFrmListarAssinaturas}"
                                tipoVisualizacao="#{layoutsComponenteSB.layoutBotoes.iconeENome}"
                                />
        </p:fragment>
        <p:fieldset legend="Assinatura do Email #{pgConfiguracoes.usuarioSelecionado.email}" rendered="#{pgConfiguracoes.usuarioSelecionado!=null}" >

            <div style="position: relative; width: 100%;">
                <SBCRM:avatar usuario="#{pgConfiguracoes.usuarioSelecionado}" somenteLeitura="true"  altura="92" />
            </div>
            <div class="quebraBlocoComEspacoVertical110"/>
            <p:fieldset styleClass="Container12 Responsive" style="height: 300px; "

                        >


                <h:inputTextarea
                    transient="true"
                    value="#{pgConfiguracoes.usuarioSelecionado.assinaturaEmail}"
                    id="ckeditorAssinatura"
                    style="width: 1px; height: 1px;"  styleClass="invisivel"/>
                <script src="#{infoWebApp.urlPagina}/libUrlPadrao/ckeditor/ckeditor.js"></script>
                <script type="text/javascript">

                    function recarregarCKassinatura() {
                        CKEDITOR.replace('#{pgUtil.gerarCaminhoCompletoID('ckeditorAssinatura')}');
                        CKEDITOR.instances['#{pgUtil.gerarCaminhoCompletoID('ckeditorAssinatura')}'].on('change', function () {
                            copiarValoresCKEditor('#{pgUtil.gerarCaminhoCompletoIDParaJavaScript('ckeditorAssinatura')}', '#{pgUtil.gerarCaminhoCompletoIDParaJavaScript('textPrime')}');
                        });
                    }
                    recarregarCKassinatura();
                </script>
                <h:inputTextarea
                    style="width: 0px; height: 0px;"
                    id="textPrime"
                    value="#{pgConfiguracoes.usuarioSelecionado.assinaturaEmail}"
                    styleClass="invisivel"

                    >

                </h:inputTextarea>
            </p:fieldset>




        </p:fieldset>
        <h:panelGroup styleClass="Fright Container3" >




            <SBAcao:botaoDeAcao metodo="#{pgConfiguracoes.salvarAssinatura()}"
                                update="@form"
                                armazenamentoAcaoExecutada="#{pgConfiguracoes.acaoSelecionada}"
                                acao="#{acoesAdminCrm_ConfiguracoesGeraisMb.configuracoesGeraisCtrSalvarAssinatura}"
                                tipoVisualizacao="#{layoutsComponenteSB.layoutBotoes.iconeENome}"
                                />


            <SBAcao:botaoDeAcao metodo="#{pgConfiguracoes.testarEnvioAssinatura()}"
                                rendered="false"
                                update="@form"
                                armazenamentoAcaoExecutada="#{pgMeuPerfil.acaoSelecionada}"
                                acao="#{acoesAtendimentoCrm_MeuPerfilMb.meuPerfilCtrTestar}"
                                tipoVisualizacao="#{layoutsComponenteSB.layoutBotoes.iconeENome}"
                                />

        </h:panelGroup>
    </h:form>
</ui:composition>

